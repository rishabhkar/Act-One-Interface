import{_ as e,a as t,c as n,f as r,h as i,i as a,o,p as s,s as c}from"./index-B_m4mG2h.js";import{t as l}from"./api-CoD7EiET.js";var u=r(`circle-check`,[[`circle`,{cx:`12`,cy:`12`,r:`10`,key:`1mglay`}],[`path`,{d:`m9 12 2 2 4-4`,key:`dzmm74`}]]),d=r(`credit-card`,[[`rect`,{width:`20`,height:`14`,x:`2`,y:`5`,rx:`2`,key:`ynyp8z`}],[`line`,{x1:`2`,x2:`22`,y1:`10`,y2:`10`,key:`1b3vmo`}]]),f=r(`loader-circle`,[[`path`,{d:`M21 12a9 9 0 1 1-6.219-8.56`,key:`13zald`}]]),p=r(`receipt-text`,[[`path`,{d:`M13 16H8`,key:`wsln4y`}],[`path`,{d:`M14 8H8`,key:`1l3xfs`}],[`path`,{d:`M16 12H8`,key:`1fr5h0`}],[`path`,{d:`M4 3a1 1 0 0 1 1-1 1.3 1.3 0 0 1 .7.2l.933.6a1.3 1.3 0 0 0 1.4 0l.934-.6a1.3 1.3 0 0 1 1.4 0l.933.6a1.3 1.3 0 0 0 1.4 0l.933-.6a1.3 1.3 0 0 1 1.4 0l.934.6a1.3 1.3 0 0 0 1.4 0l.933-.6A1.3 1.3 0 0 1 19 2a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1 1.3 1.3 0 0 1-.7-.2l-.933-.6a1.3 1.3 0 0 0-1.4 0l-.934.6a1.3 1.3 0 0 1-1.4 0l-.933-.6a1.3 1.3 0 0 0-1.4 0l-.933.6a1.3 1.3 0 0 1-1.4 0l-.934-.6a1.3 1.3 0 0 0-1.4 0l-.933.6a1.3 1.3 0 0 1-.7.2 1 1 0 0 1-1-1z`,key:`ycz6yz`}]]),m=e(),h=250;function g(e,t=`Prarambh Tickets`){let n=(Number.isFinite(e)?Math.max(1,Math.floor(e)):1)*h;return{amount:n,params:new URLSearchParams({pa:`prarambh.62803183@hdfcbank`,pn:`PRARAMBH`,cu:`INR`,am:n.toFixed(2),tn:t})}}function _(e=navigator.userAgent){return/Android/i.test(e)}function v(e=navigator.userAgent){return/iPhone|iPad|iPod/i.test(e)}function y(e=navigator.userAgent){return _(e)||v(e)}var b=[{id:`gpay`,label:`Google Pay`,build:e=>`gpay://upi/pay?${e}`},{id:`phonepe`,label:`PhonePe`,build:e=>`phonepe://pay?${e}`},{id:`paytm`,label:`Paytm`,build:e=>`paytmmp://upi/pay?${e}`},{id:`bhim`,label:`BHIM`,build:e=>`bhim://upi/pay?${e}`},{id:`browser`,label:`Open in Browser`,build:e=>`https://upi.link/pay?${e}`}];function x({ticketCount:e,note:t=`Prarambh Tickets`}){let{params:n}=g(e,t);return`upi://pay?${n.toString()}`}function S({ticketCount:e,note:t=`Prarambh Tickets`}){let{params:n}=g(e,t);return`https://upi.link/pay?${n.toString()}`}function C(e,t){return`intent://${e.replace(/^upi:\/\//,``)}#Intent;scheme=upi;S.browser_fallback_url=${encodeURIComponent(t)};end`}function w(e){let{params:t}=g(e.ticketCount,e.note),n=t.toString();return b.map(e=>({id:e.id,label:e.label,href:e.build(n)}))}function T(e){if(typeof window>`u`)return Promise.resolve({status:`failed`,reason:`timeout`});if(!y())return Promise.resolve({status:`not_supported`,reason:`desktop_or_unknown`});let t=x(e),n=S(e);return _()?(window.location.href=C(t,n),Promise.resolve({status:`launched`,via:`native`})):v()?Promise.resolve({status:`manual_selection_required`,reason:`ios_app_selection`,apps:w(e)}):(window.location.href=t,Promise.resolve({status:`launched`,via:`native`}))}var E=s();function D(e){let t={};e.showId||(t.showId=`Missing show selection.`),e.auditoriumId||(t.auditoriumId=`Missing auditorium selection.`),(!e.ticketCount||e.ticketCount<1||e.ticketCount>10)&&(t.ticketCount=`Ticket quantity must be between 1 and 10.`),e.fullName.trim()||(t.fullName=`Full name is required.`);let n=e.email.trim();return n?/^\S+@\S+\.\S+$/.test(n)||(t.email=`Please enter a valid email.`):t.email=`Email is required.`,e.phoneNumber.trim()||(t.phoneNumber=`WhatsApp number is required.`),e.consent||(t.consent=`Please confirm consent to be contacted.`),t}function O(){let[e]=i(),r=e.get(`showId`)??``,s=e.get(`auditoriumId`)??``,[h,g]=(0,m.useState)(null);(0,m.useEffect)(()=>{let e=!1;return a().then(t=>{e||g(t)}).catch(()=>{e||g([])}),()=>{e=!0}},[]);let _=(0,m.useMemo)(()=>{let e=h??[],t=s?e.find(e=>e.auditoriumId===s):null,n=!t&&r?e.find(e=>e.showId===r):null;return t??n??null},[h,s,r]),v=(0,m.useMemo)(()=>({showId:_?.showId??r??``,auditoriumId:_?.auditoriumId??s??``,ticketCount:1,fullName:``,email:``,phoneNumber:``,consent:!1}),[_,r,s]),[y,b]=(0,m.useState)(`details`),[x,S]=(0,m.useState)(v),[C,w]=(0,m.useState)({}),[O,k]=(0,m.useState)({status:`idle`}),[A,j]=(0,m.useState)(``),[M,N]=(0,m.useState)(!1),[P,F]=(0,m.useState)([]),I=(0,m.useRef)(null);(0,m.useEffect)(()=>{S(v)},[v]),(0,m.useEffect)(()=>{I.current&&I.current.scrollIntoView({behavior:`smooth`,block:`start`})},[y]);let L=(0,m.useMemo)(()=>(Number.isFinite(x.ticketCount)?Math.max(1,Math.floor(x.ticketCount)):1)*(_?.ticketAmount??0),[x.ticketCount,_?.ticketAmount]);async function R(e){e.preventDefault(),k({status:`idle`}),N(!1),F([]);let t=D(x);if(w(t),Object.keys(t).length){k({status:`error`,message:`Please fix the highlighted fields and try again.`});return}b(`transaction`);try{let e=await T({ticketCount:x.ticketCount});e.status===`manual_selection_required`?(F(e.apps),k({status:`error`,message:`Choose your preferred UPI app below to continue payment on iOS.`})):e.status===`not_supported`?(N(!0),k({status:`error`,message:`This payment link opens only on a phone with a UPI app. Scan the QR below or reopen this page on your phone to continue.`})):e.status===`failed`&&k({status:`error`,message:`We could not open your UPI app. Try Payment again or scan the QR below to pay.`})}catch{k({status:`error`,message:`Something interrupted the UPI launch. Please try again or scan the QR below.`})}}async function z(e){if(e.preventDefault(),k({status:`idle`}),!_){k({status:`error`,message:`Unable to load show details. Please go back and select a show again.`});return}let t=A.trim();if(!t){k({status:`error`,message:`Please enter your transaction ID to continue.`});return}let n=D(x);if(w(n),Object.keys(n).length){k({status:`error`,message:`Please fill all required details before confirming.`});return}k({status:`loading`});try{k({status:`success`,ticketId:(await l({showId:_.showId,auditoriumId:_.auditoriumId,showName:_.showName,fullName:x.fullName.trim(),email:x.email.trim(),ticketCount:Math.max(1,Math.floor(x.ticketCount||1)),ticketAmount:L,phoneNumber:x.phoneNumber.trim(),transactionId:t})).ticketId}),j(``),b(`details`),w({}),S(v),N(!1),F([])}catch(e){k({status:`error`,message:e instanceof Error?e.message:`Something went wrong.`})}}let B=(0,m.useMemo)(()=>{if(!_)return null;let e=new Date(`${_.showDate}T00:00:00`),t=Number.isNaN(e.getTime())?_.showDate:e.toLocaleDateString(void 0,{weekday:`long`,day:`numeric`,month:`long`,year:`numeric`}),[n,r]=(_.showTime??``).split(`:`),i=new Date;return i.setHours(Number(n||0),Number(r||0),0,0),`${t} · ${_.showTime?i.toLocaleTimeString(void 0,{hour:`numeric`,minute:`2-digit`,hour12:!0}):``}`},[_]),V=(0,m.useMemo)(()=>({"--glass-gradient":`linear-gradient(145deg, rgba(0, 0, 0, 0.55) 0%, rgba(0, 0, 0, 0.32) 55%, rgba(0, 0, 0, 0.18) 100%)`}),[]);return(0,E.jsxs)(`div`,{className:`mx-auto max-w-6xl px-4`,children:[(0,E.jsx)(t,{children:(0,E.jsxs)(`header`,{className:`pt-8 sm:pt-10`,children:[(0,E.jsx)(`h1`,{className:`font-serif text-4xl text-white sm:text-5xl`,children:c.bookingPage.pageTitle}),(0,E.jsx)(`p`,{className:`mt-3 max-w-prose text-white/70`,children:c.bookingPage.intro}),_?(0,E.jsxs)(`p`,{className:`mt-4 text-sm text-white/70`,children:[`Booking for `,(0,E.jsx)(`span`,{className:`font-semibold text-white`,children:_.showName}),` ·`,` `,(0,E.jsx)(`span`,{className:`text-white`,children:B}),` ·`,` `,(0,E.jsx)(`span`,{className:`text-white`,children:_.auditoriumName})]}):null]})}),(0,E.jsxs)(`div`,{className:`mt-6 grid gap-6 md:mt-8 md:grid-cols-[1.2fr_0.8fr]`,children:[(0,E.jsx)(t,{children:(0,E.jsx)(`div`,{ref:I,children:(0,E.jsxs)(o,{className:`p-6 sm:p-7 md:p-10`,labelledBy:`booking-form-title`,style:V,children:[(0,E.jsxs)(`div`,{className:`flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between`,children:[(0,E.jsx)(`h2`,{id:`booking-form-title`,className:`font-serif text-2xl text-white`,children:y===`details`?`Your details`:`Confirm booking`}),(0,E.jsxs)(`div`,{className:`text-xs text-white/55`,children:[`Step `,y===`details`?`1`:`2`,` of 2`]})]}),O.status===`success`&&(0,E.jsxs)(`div`,{role:`status`,className:`mt-5 rounded-2xl border border-emerald-400/20 bg-emerald-500/10 px-4 py-3 text-sm text-emerald-100`,children:[(0,E.jsxs)(`div`,{className:`flex items-center gap-2 font-semibold`,children:[(0,E.jsx)(u,{className:`h-4 w-4`,"aria-hidden":`true`}),`Transaction recorded`]}),(0,E.jsx)(`div`,{className:`mt-1 text-emerald-100/90`,children:`Transaction recorded. Tickets will be issued after manual approval. You will receive the tickets over the registered email within 48 hours.`}),(0,E.jsxs)(`div`,{className:`mt-2 text-emerald-100/90`,children:[`Ticket ID: `,(0,E.jsx)(`span`,{className:`font-semibold`,children:O.ticketId})]})]}),O.status===`error`&&(0,E.jsxs)(`div`,{role:`alert`,className:`mt-5 rounded-2xl border border-red-400/20 bg-red-500/10 px-4 py-3 text-sm text-red-100`,children:[(0,E.jsx)(`div`,{className:`font-semibold`,children:c.bookingPage.form.errorState.title}),(0,E.jsx)(`div`,{className:`mt-1 text-red-100/90`,children:O.message})]}),y===`details`?(0,E.jsxs)(`form`,{className:`mt-6 space-y-5`,onSubmit:R,noValidate:!0,children:[(0,E.jsxs)(`div`,{children:[(0,E.jsx)(`label`,{className:`label`,htmlFor:`ticketCount`,children:`Number of tickets (1–10)`}),(0,E.jsx)(`input`,{id:`ticketCount`,className:`field mt-2`,type:`number`,min:1,max:10,value:x.ticketCount,onChange:e=>S(t=>({...t,ticketCount:Number(e.target.value)})),"aria-invalid":!!C.ticketCount,"aria-describedby":C.ticketCount?`ticketCount-error`:void 0,required:!0}),C.ticketCount&&(0,E.jsx)(`div`,{id:`ticketCount-error`,className:`error mt-2`,children:C.ticketCount})]}),(0,E.jsxs)(`div`,{className:`grid gap-5 md:grid-cols-2`,children:[(0,E.jsxs)(`div`,{children:[(0,E.jsx)(`label`,{className:`label`,htmlFor:`fullName`,children:`Full name`}),(0,E.jsx)(`input`,{id:`fullName`,className:`field mt-2`,autoComplete:`name`,value:x.fullName,onChange:e=>S(t=>({...t,fullName:e.target.value})),"aria-invalid":!!C.fullName,"aria-describedby":C.fullName?`fullName-error`:void 0,required:!0}),C.fullName&&(0,E.jsx)(`div`,{id:`fullName-error`,className:`error mt-2`,children:C.fullName})]}),(0,E.jsxs)(`div`,{children:[(0,E.jsx)(`label`,{className:`label`,htmlFor:`email`,children:`Email address`}),(0,E.jsx)(`input`,{id:`email`,className:`field mt-2`,type:`email`,autoComplete:`email`,value:x.email,onChange:e=>S(t=>({...t,email:e.target.value})),"aria-invalid":!!C.email,"aria-describedby":C.email?`email-error`:void 0,required:!0}),C.email&&(0,E.jsx)(`div`,{id:`email-error`,className:`error mt-2`,children:C.email})]})]}),(0,E.jsxs)(`div`,{children:[(0,E.jsx)(`label`,{className:`label`,htmlFor:`phoneNumber`,children:`WhatsApp number`}),(0,E.jsx)(`input`,{id:`phoneNumber`,className:`field mt-2`,type:`tel`,autoComplete:`tel`,value:x.phoneNumber,onChange:e=>S(t=>({...t,phoneNumber:e.target.value})),"aria-invalid":!!C.phoneNumber,"aria-describedby":C.phoneNumber?`phone-error`:void 0,required:!0}),C.phoneNumber&&(0,E.jsx)(`div`,{id:`phone-error`,className:`error mt-2`,children:C.phoneNumber})]}),(0,E.jsxs)(`div`,{className:`flex items-start gap-3`,children:[(0,E.jsx)(`input`,{id:`consent`,type:`checkbox`,className:`mt-1 h-4 w-4 rounded border-white/20 bg-white/10`,checked:x.consent,onChange:e=>S(t=>({...t,consent:e.target.checked})),"aria-invalid":!!C.consent,"aria-describedby":C.consent?`consent-error`:`consent-hint`}),(0,E.jsxs)(`div`,{children:[(0,E.jsx)(`label`,{className:`label`,htmlFor:`consent`,children:`I agree to receive booking updates`}),(0,E.jsx)(`div`,{id:`consent-hint`,className:`hint mt-1`,children:`We’ll only use your details for booking updates.`}),C.consent&&(0,E.jsx)(`div`,{id:`consent-error`,className:`error mt-1`,children:C.consent})]})]}),(0,E.jsxs)(`div`,{className:`flex flex-col gap-3 sm:flex-row sm:items-center`,children:[(0,E.jsxs)(`button`,{type:`submit`,className:`btn-primary`,children:[(0,E.jsx)(d,{className:`h-4 w-4`,"aria-hidden":`true`}),`Payment`]}),(0,E.jsx)(`button`,{type:`button`,className:`btn-secondary`,onClick:()=>{S(v),w({}),j(``),b(`details`),k({status:`idle`}),N(!1),F([])},children:`Reset`})]}),(0,E.jsx)(`p`,{className:`text-xs text-white/55 whitespace-nowrap overflow-x-auto`,children:`Share your details, proceed to payment, then enter your transaction ID to confirm your seats.`})]}):(0,E.jsxs)(`form`,{className:`mt-6 space-y-5`,onSubmit:z,children:[P.length>0&&(0,E.jsxs)(`div`,{className:`rounded-2xl border border-white/10 bg-white/5 p-4`,children:[(0,E.jsx)(`div`,{className:`text-sm font-semibold text-white`,children:`Open payment in your UPI app`}),(0,E.jsx)(`div`,{className:`mt-1 text-xs text-white/60`,children:`iOS needs a direct link. Tap the app you use to switch over and finish the payment.`}),(0,E.jsx)(`div`,{className:`mt-4 grid gap-3 sm:grid-cols-2`,children:P.map(e=>(0,E.jsx)(`button`,{type:`button`,className:`rounded-xl border border-white/15 bg-white/10 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/20`,onClick:()=>{window.location.href=e.href},children:e.label},e.id))}),(0,E.jsx)(`div`,{className:`mt-3 text-xs text-white/60`,children:`Nothing happening? Use the QR below or copy the browser option to share the link manually.`})]}),(0,E.jsx)(`div`,{className:(M?`block`:`hidden md:block`)+` rounded-2xl border border-white/10 bg-white/5 p-4`,children:(0,E.jsxs)(`div`,{className:`flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between`,children:[(0,E.jsxs)(`div`,{className:`min-w-0`,children:[(0,E.jsx)(`div`,{className:`text-sm font-semibold text-white`,children:`Pay via QR`}),(0,E.jsx)(`div`,{className:`mt-1 text-xs text-white/60`,children:`Scan this QR using any UPI app on your phone and pay the exact amount.`}),(0,E.jsxs)(`div`,{className:`mt-3 text-sm text-white/80`,children:[`Amount payable: `,(0,E.jsxs)(`span`,{className:`font-semibold text-white`,children:[`₹ `,L]})]}),(0,E.jsxs)(`div`,{className:`mt-1 text-xs text-white/60`,children:[`(₹ `,L,` × `,Math.max(1,Math.floor(x.ticketCount||1)),` tickets)`]})]}),(0,E.jsx)(`div`,{className:`mx-auto w-full max-w-[320px] flex-shrink-0`,children:(0,E.jsx)(`div`,{className:`overflow-hidden rounded-xl border border-white/10 bg-black/20 p-3`,children:(0,E.jsx)(`img`,{src:new URL(`/assets/QR%20Code-BR40h-9P.webp`,``+import.meta.url).toString(),alt:`Prarambh UPI QR code`,className:`h-auto w-full`,decoding:`async`})})})]})}),(0,E.jsxs)(`div`,{children:[(0,E.jsx)(`label`,{className:`label`,htmlFor:`transactionId`,children:`Transaction ID`}),(0,E.jsx)(`input`,{id:`transactionId`,className:`field mt-2`,inputMode:`text`,autoComplete:`off`,value:A,onChange:e=>j(e.target.value),placeholder:`e.g. UPI/IMPS/bank reference`,disabled:O.status===`loading`||O.status===`success`}),(0,E.jsx)(`div`,{className:`hint mt-2`,children:`We’ll use this to validate and reconcile your payment.`})]}),(0,E.jsxs)(`div`,{className:`flex flex-col gap-3 sm:flex-row sm:items-center`,children:[(0,E.jsx)(`button`,{type:`submit`,className:`btn-primary`,disabled:O.status===`loading`||O.status===`success`,children:O.status===`loading`?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(f,{className:`h-4 w-4 animate-spin`,"aria-hidden":`true`}),`Confirming…`]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(p,{className:`h-4 w-4`,"aria-hidden":`true`}),`Confirm booking`]})}),(0,E.jsx)(`button`,{type:`button`,className:`btn-secondary`,disabled:O.status===`loading`,onClick:()=>{k({status:`idle`}),b(`details`),N(!1),F([])},children:`Back`})]}),(0,E.jsx)(`p`,{className:`text-xs text-white/55`,children:`We’ll issue your ticket(s) only after you confirm the transaction ID.`})]})]})})}),(0,E.jsx)(t,{delay:.08,children:(0,E.jsxs)(o,{className:`p-6 sm:p-7 md:p-10`,labelledBy:`summary-title`,style:V,children:[(0,E.jsx)(`h2`,{id:`summary-title`,className:`font-serif text-2xl text-white`,children:`Summary`}),(0,E.jsxs)(`div`,{className:`mt-4 space-y-3 text-sm text-white/75`,children:[(0,E.jsxs)(`div`,{className:`flex items-start justify-between gap-3`,children:[(0,E.jsx)(`div`,{className:`text-white/60`,children:`Selected show`}),(0,E.jsx)(`div`,{className:`text-right text-white`,children:_?_.showName:`—`})]}),(0,E.jsxs)(`div`,{className:`flex items-start justify-between gap-3`,children:[(0,E.jsx)(`div`,{className:`text-white/60`,children:`When`}),(0,E.jsx)(`div`,{className:`text-right text-white`,children:_?B:`—`})]}),(0,E.jsxs)(`div`,{className:`flex items-start justify-between gap-3`,children:[(0,E.jsx)(`div`,{className:`text-white/60`,children:`Where`}),(0,E.jsx)(`div`,{className:`text-right text-white`,children:_?_.auditoriumName:`—`})]}),(0,E.jsxs)(`div`,{className:`flex items-start justify-between gap-3`,children:[(0,E.jsx)(`div`,{className:`text-white/60`,children:`Tickets`}),(0,E.jsx)(`div`,{className:`text-right text-white`,children:x.ticketCount})]}),(0,E.jsxs)(`div`,{className:`rounded-2xl border border-white/10 bg-white/5 p-4`,children:[(0,E.jsx)(`div`,{className:`text-sm font-semibold text-white`,children:`Booking Procedure`}),(0,E.jsxs)(`ol`,{className:`mt-2 list-decimal space-y-1 pl-5 text-xs text-white/65`,children:[(0,E.jsx)(`li`,{children:`Fill in the registration details`}),(0,E.jsx)(`li`,{children:`Click on Payment.`}),(0,E.jsx)(`li`,{children:`You will be re-directed to UPI`}),(0,E.jsx)(`li`,{children:`Pay and copy the transaction ID`}),(0,E.jsx)(`li`,{children:`Paste it here to confirm booking`})]}),(0,E.jsx)(`div`,{className:`mt-3 text-xs text-white/60`,children:`Booking confirmation will be send with tickets on email within next 48 hours.`})]}),(0,E.jsxs)(`div`,{className:`rounded-2xl border border-white/10 bg-white/5 p-4`,children:[(0,E.jsx)(`div`,{className:`text-sm font-semibold text-white`,children:`Status`}),(0,E.jsx)(`div`,{className:`mt-1 text-xs text-white/60`,children:O.status===`success`?`Booking confirmed`:y===`details`?`Awaiting payment`:`Awaiting transaction ID confirmation`})]}),(0,E.jsxs)(`div`,{className:`flex items-center gap-2 text-xs text-white/50`,children:[(0,E.jsx)(n,{className:`h-4 w-4`,"aria-hidden":`true`}),`Tickets are issued after transaction ID submission.`]})]})]})})]})]})}export{O as default};