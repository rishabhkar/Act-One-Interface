import{g as e}from"./index-TpK_6I21.js";function t(e){return Math.max(0,Math.min(255,e|0))}function n({r:e,g:n,b:r},i=1){return`rgba(${t(e)}, ${t(n)}, ${t(r)}, ${i})`}function r({r:e,g:t,b:n}){return .2126*e+.7152*t+.0722*n}function i({r:e,g:t,b:n}){let r=Math.max(e,t,n);return r===0?0:(r-Math.min(e,t,n))/r}function a(e){if(!e||!e.length)return null;let t=e[0],r=e[1]??e[0];return`linear-gradient(${220+((t.r*3+t.g*2+t.b*5+r.r+r.g+r.b)/6|0)%100}deg, ${n(t,.52)} 0%, ${n(r,.34)} 28%, rgba(40, 55, 95, 0.34) 52%, rgba(0, 10, 55, 0.82) 78%, ${n({r:0,g:8,b:28},.92)} 100%)`}function o(e,{maxColors:t=2,ignoreNearBlackLuma:n=18,ignoreNearWhiteLuma:a=242,ignoreLowSat:o=.12}={}){let s=new Map;for(let t=0;t<e.length;t+=4){if(e[t+3]<40)continue;let c=e[t],l=e[t+1],u=e[t+2],d=r({r:c,g:l,b:u});if(d<=n||d>=a||i({r:c,g:l,b:u})<o)continue;let f=`${c>>3},${l>>3},${u>>3}`,p=s.get(f);p?(p.c+=1,p.r+=c,p.g+=l,p.b+=u):s.set(f,{c:1,r:c,g:l,b:u})}let c=[...s.values()].sort((e,t)=>t.c-e.c);if(!c.length)return null;let l=[];for(let e of c){let n={r:e.r/e.c,g:e.g/e.c,b:e.b/e.c};if(!l.some(e=>{let t=e.r-n.r,r=e.g-n.g,i=e.b-n.b;return t*t+r*r+i*i<1225})&&(l.push(n),l.length>=t))break}return l.length?l:null}var s=e(),c=new Map;function l(e,{enabled:t=!0,cacheKey:n}){let r=n??null,i=(0,s.useMemo)(()=>r?c.get(r)??null:null,[r]),[l,u]=(0,s.useState)(null);return(0,s.useEffect)(()=>{if(!t)return;let n=e.current;if(!n||!r||i)return;let s=!1,l=()=>{if(!s)try{let e=document.createElement(`canvas`);e.width=48,e.height=48;let t=e.getContext(`2d`,{willReadFrequently:!0});if(!t)return;t.drawImage(n,0,0,48,48);let i=t.getImageData(0,0,48,48).data,s=a(o(i));if(!s)return;c.set(r,s),u({key:r,gradient:s})}catch{u({key:r,gradient:null})}},d=()=>requestAnimationFrame(l);if(n.complete&&n.naturalWidth>0)d();else return n.addEventListener(`load`,d,{once:!0}),()=>{s=!0,n.removeEventListener(`load`,d)};return()=>{s=!0}},[t,e,r,i]),i||(r&&l?.key===r?l.gradient:null)}export{l as t};